;;;; Copyright (c) 2014 RD Projekt Sp. z o.o. Sp. k.
;;;; http://www.rdprojekt.pl/
;;;; Use is subject to license terms.
;;;;
;;;; This file is part of CL-JSON-LD.
;;;;
;;;; CL-JSON-LD is free software: you can redistribute it and/or modify
;;;; it under the terms of the GNU General Public License as published by
;;;; the Free Software Foundation, either version 3 of the License, or
;;;; (at your option) any later version.
;;;;
;;;; CL-JSON-LD is distributed in the hope that it will be useful,
;;;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;;;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;;; GNU General Public License for more details.
;;;;
;;;; You should have received a copy of the GNU General Public License
;;;; along with CL-JSON-LD.  If not, see <http://www.gnu.org/licenses/>.

(in-package :cl-json-ld)

(defun normalize (input &optional (options nil))
  "Perform RDF normalization on the given JSON-LD input.

  Converted from pyld's normalize function."
  
  ;; Set default options
  (plist-setdefault options :base (if (stringp input) input ""))
  (plist-setdefault options :document-loader *default-document-loader*)
  
  ;; Convert to RDF dataset, then do normalization.
  (let ((opts (copy-list options)))
    (remf opts :format)
    (setf (getf opts :produce-generalized-rdf) nil)
  
    (let ((dataset (handler-bind 
                       ((json-ld-error #'(lambda (cause)
                                           (error 'json-ld-error
                                             :message "Could not convert input to RDF dataset before normalization."
                                             :cause cause))))
                     (to-rdf input opts))))
      ;; do normalization
      (internal-normalize dataset options))))


(defun internal-normalize (dataset options)
  "Perform RDF normalization on the given RDF dataset.

  Converted from pyld's JsonLdProcessor._normalize method."
  ;; create quads and map bnodes to their associated quads
  (multiple-value-bind (quads bnodes) (map-quad-bnodes dataset)
    
    ;; mapping complete, start canonical naming
    (let ((namer (make-namer "_:c14n")))
      
      (assign-bnode-names bnodes namer)
      
      (let ((normalized (get-normalized-quads quads namer)))
        ;; Handle output format
        (let ((format (getf options :format)))
          (if format
              (if (equal format "application/nquads")
                  (format nil "狺铒蝽犰辁邃ㄥ蝌矧ш箫瞽熹弪蝻喉弩筢珏ㄦ矧磲铋⒄铍铒黝秕麴豸骘蝽狒螈骘蝽狒┅屐箦疳蝮瀛铖踽潴ㄦ矧磲铋狺铒蝽犰辁邃┅┅┅┅ㄡ戾犷潋獒轰彐轭瀛泔铙翎铘聃徜狒趄螳扉篝后踱赍泗猴怅邈侯犴濠呼弩＇羼踽飑ㄤ彐躅磲瓠聃徜忸镤弩ㄤ狒狍弭⒚蝈狒聃徜犷磲忸镤弩麸翳彘狍箫汩狒邃聃徜螽义趱蝾赭鲠祯弩聃徜轶澌钺黹狎蜥镦聃徜ㄥ徙聃徜轶蝈痱弩孱翦怡痨轶舂忸镤弩轶栳箬翎忪鏖翳脲忮轭钺礤镦忸镤弩犷鲠祯弩忮轭痨轶趔麒矬箝铉戾厚踽潴痱镳弪糸弩脲屦澌钺黹狎蜥镦聃徜狍箫汩狒邃鏖翳翳忸镤瀹戾è聃徜磲脲澌钺黹悱狎蜥┅ㄢ铒溴磲脲篝蜷铉栳箬翎忪濠┅祜镳骘珧狃璀钺礤忮轭翳栳箬脲镦溽翎箦躞轭ㄨ狍璀鲠祯趄轲戾螬滹麒孱ㄥ聃犰珧狃璀钺礤溴驷蹯舡珧狃璀钺礤箦翩珧狃璀钺礤铋飑祜镳骘趄轲戾徙蝻篌趄轲戾滹戾è聃徜ㄣ镳扉篝趄轲戾┅麒孱珧狃璀钺礤箦翩ㄧ弭聃徜侯犴濠磲脲趄轲戾屐屙ㄩㄢ灬铍钺礤珧狃璀钺礤忪犷氕铒溴豉疱轵榄豉疱珧狃璀钺礤┅鲥泗矧瘐箬屮翦钿聃徜聃徜螬祜镳骘狒趄轭聃徜狒趄螳骘趄轲戾屐屙ㄧ弭聃徜狒趄麒孱ㄡ钿趄轲戾屐屙ㄥ聃犰ㄧ弭趄轲戾屐屙呼疱忪犷氕铒溴豉疱┅滹戾舄è趄轲戾鲠祯ㄧ弭趄轲戾屐屙忽犰蹂┅ㄢ铒溴ㄧ弭栳箬趄轲戾鲠祯忸镤弩Ж┅聃徜ㄧ弭忸镤厚踽潴┅躅戾篌聃徜箦翩聃徜磲脲澌钺黹悱狎蜥ㄧ弭忸镤厚踽潴聃徜ㄧ弭栳箬趄轲戾鲠祯忸镤弩忸镤濠鲥泗矧瘐箬屮翦钿聃徜聃徜螬┅┅鲠祯弩聃徜忸镤弩┅ㄤ彐躅狍箝珙忸镤瀛钺礤ㄢ铒溴钺礤颟⑵殪钺礤颛汜汨鏖翳钺礤镦忸镤弩戾è漉痨殂狒弩ㄡ篌殓瞽躅轳蹂钺礤忸镤弩钺礤颟┅ㄡ篌殓瞽漉痨殂狒瀛钺礤漉痨殂狒弩忸镤弩钺礤颟┅ㄤ彐躅狍箝珙躅轳蹂钺礤ㄢ铒溴钺礤颟⒚镱糸铛麸栳箬忸镤聃徜麒殪忸镤弩狎狍箝珙邃钺礤螽义趱蝾栳箬翎忪镦漉痨殂狒弩ㄤè躅钺礤ㄡ戾犷潋獒鸿狍璀翎忪瀛脲忸镤弩蝈鲥蝮铄舡躅钺礤洎铄舡躅钺礤ЖЖ┅ㄤ躔扉汜翦磲脲篝蜷铉栳箬翎忪濠磲脲篝蜷铉栳箬翎忪濠躅轳蹂磲脲篝蜷铉栳箬翎忪濠磲脲篝蜷铉栳箬翎忪濠┅铋飑祜镳躅糸屮痨殂轸蝈趱蝾祜镳骘忸镤轭躅钺礤换柔箬聃徜骘遽汨躅钺礤忸镤骘栳箬ㄨ狍璀聃徜忸镤忸镤弩骘漉痨殂狒瀛孱趄ㄧ弭栳箬栳箬漉痨殂狒弩骘躅轳蹂孱趄ㄧ弭栳箬栳箬躅轳蹂滹换郁矧栳箬狍躅轳蹂矧漉痨殂狒ㄣ镱ㄤ躔扉汜翦孱趄鲥泗矧瘐箬屮翦钿忸镤漉痨殂狒瀛孱趄瘐箬忸镤铄舡躅钺礤洎躅轳蹂孱趄戾è栳箬漉痨殂狒弩磲脲澌钺黹悱狎蜥┅鲥泗矧瘐箬屮翦钿躅轳蹂孱趄栳箬漉痨殂狒弩鲥泗矧瘐箬屮翦钿忸镤栳箬漉痨殂狒弩箦翩ㄧ弭栳箬栳箬漉痨殂狒弩栳箬漉痨殂狒弩瘐箬躅轳蹂孱趄铄舡躅钺礤洎瘐箬忸镤铄舡躅钺礤洎蝈龛狍栳箬躅轳蹂┅箦翩ㄧ弭栳箬栳箬躅轳蹂忸镤濠┅换吾礤躅轳蹂忸镤弩轭箫螋邃栳箬矧溴箫螋邃磲痂狍＇灬礅溽ㄨ狍忸镤濠ㄤ邈灬蝈ㄩ珙矧栳箬┅钺礤颦珏舡钺礤钺礤忸镤濠躅轳蹂换娘铄麒孱铒盹蝈忸镤弩钺礤麒孱戾铉翳躅钺礤洎戾铉翳铄舡躅钺礤洎蝈趱蝾漉痨殂狒弩┅┅ㄤ彐躅狍箝珙漉痨殂狒瀛钺礤ㄤ躔扉汜翦忸镤弩钺礤颟⑴铛礤蜥翦漉痨殂狒栳箬珧秕痼轭箫螋邃矧溴虍ㄦ戾è痱镢弩蟓珧秕ㄨ狍珧秕皓ㄤ邈灬蝈ㄩ珙矧栳箬┅戾è蝈篚祠祜镳骘忸镤徙蝻篌珧秕躅戾篌钺礤颦轶钺礤钺礤忸镤濠箅轲犰蝈徜钺礤忸镤弩换栳箬忸镤疳翳泔祆邈戾è疳翳钺礤磲脲钺礤颟┅钺礤颦珏舡钺礤疳翳钺礤忸镤濠ㄨ狍璀疳翳忸镤忸镤弩钺礤疳翳钺礤颟┅┅换吾礤忸镤弩轭栳箬矧溴箦翩蝈篚祠箫螋蝈篚祠＇篝蜷铉弘妁＇灬礅溽ㄧ弭鸿狍瑭┅祜镳骘蝈篚祠轭蝈篚祠滹祜镳骘忸镤徙蝻篌钺礤颦矧溴ㄧ弭蝈篚祠吼狒璀钺礤颟滹钺礤颦珏舡钺礤钺礤忸镤濠┅┅箫螋邃磲痂狍＇痱镢弩蟓珧秕漉痨殂狒弩┅ㄤ彐躅聃徜钺礤鲠祯聃徜⒁弭躜翳鲠祯镦侯犴痱镳弪豉镦聃徜殒痱弩孱舢戾è聃徜钺礤ㄧ弭聃徜侯犴濠┅ㄩ聃徜钺礤ㄧ弭聃徜钺礤忽犰蹂铋飑┅ㄤ彐躅珏舡铒蝽犰辁邃聃徜聃徜钺礤颟⒘翳轶痫轭犰忸镤弩轭翳箦镦夷聃徜栳鲥忮孱狍箝珙邃汜铒铋汜钺礤蟋麒殂栳鲥忮孱篝矧邃轭翳ь犴弪镡赍泗儒蝈遽汨聃徜轶躔溽翦怡狍箝珙轭遽汨镦轸忸镤弩轸铄钺礤鲩翳ь犴弪镡赍泗义趱蝾扉篝镦篝蜷铉蝈痱弩孱糸铉夷聃徜螽戾è铒蝽犰辁邃祜镳骘聃徜徙蝻篌聃徜滹祜镳骘狒趄轭聃徜狒趄螳骘聃徜狒趄ㄧ弭聃徜狒趄麒孱ㄡ钿ㄥ聃犰ㄧ弭聃徜狒趄呼疱忪犷氕铒溴豉疱铒篝狎趔鏖翳ㄧ弭聃徜狒趄忽犰蹂⑦恒贝睥┅滹箦翩ㄧ弭聃徜狒趄忽犰蹂钺礤颦珏舡钺礤钺礤ㄧ弭聃徜狒趄忽犰蹂┅┅泔祆邈趄轲戾绢聃徜聃徜聃徜钺礤鲠祯聃徜┅┅箦翩铒蝽犰辁邃箫螋铒蝽犰辁邃＇篝蜷铉缉铒蝽犰辁邃┅ㄤ彐躅栳箬聃徜ㄩ忸镤弩⑷狍犰镦翳聃徜徕秕忪犷铒溴忸镤弩轶篝蜷铉栳箬翎忪麒矬鲠祯弩狎痨轶趔鏖翳脲蠛鸿狍汜汨邃栳箬厚踽潴澌钺黹狎蜥鏖翳聃徜轸屙痨轶趔┊蔑铞弪翦骝镯瘗熹鼠镱啼序镢弩箫虍哞狍柽聃徜礤翳镤戾è忸镤ㄧ弭栳箬殇忸镤弩┅换义趱蝾汜汨邃栳箬戾è汜汨邃ㄧ弭忸镤鸿狍瑭┅麒孱汜汨邃蝈趱蝾骝镯栳箬聃徜汜汨邃┅换渝蜷犰辁犰镦忸镤濮聃徜戾è铖踽潴祜镳骘聃徜徙蝻篌ㄧ弭忸镤厚踽潴泔祆邈趄轲戾绢聃徜聃徜聃徜钺礤鲠祯聃徜衡铒溴殇┅┅换语螋箦蜷犰辁邃聃徜箦翩铖踽潴箫螋铖踽潴＇篝蜷铉缉换冕汨犷蝈趱蝾栳箬邃聃徜戾è聃徜蟓栳箬箬岜栳箬篝蜷铉铖踽潴┅箦翩ㄧ弭忸镤鸿狍瑭聃徜蟓栳箬ㄧ弭栳箬殇忸镤弩忸镤濠聃徜蟓栳箬┅┅ㄤ彐躅栳箬疳翳ㄩ忸镤弩钺礤疳翳钺礤颟⑿蝻漉沐栳箬骘翳疳翳镦徜赆沐铘忸镤弩骘忸镤瀣轭泔蝠矧狒轭犰轭骘蝽狒轱徕秕轸篚忡蜥痂镦忸镤弩澡轶礤翳镤鏖祆蝈沲蝮轹屐痖汶徜赆沐铘忸镤疱蝽豸狒轱铙翳狒痱镤蹉翳戾殂镧蜥痂殂犰禊戾狍ю狒瑙箦蜷犰辁狒轱铙吼狎犴殇翳赡镦翳忸镤麸栳箬疳翳骘虍吼狎犴忸镤弩翳栳箬翎忪镦忸镤聃徜螽吼狎犴钺礤蚝翳汜铒铋汜忸镤钺礤虍吼狎犴疳翳哳犴弪翳钺礤躞邃麸狍箝珙钺礤麸徜赆沐铘忸镤弩义趱蝾痨轶鏖翳鸿狍犷吼狒璀钺礤脲螽蔑铞弪翦骝镯瘗熹鼠镱啼序镢弩箫虍哞狍柽疳翳礤翳镤戾è珧秕痼ㄧ蝻躔忸镤弩怡栳箬殇忸镤弩钺礤疳翳钺礤颟ㄤ殓弩翦磲脲箬岜溟珏篝弪┅换㈢蝻躔螈轶栳箬磲鏖翳狎蜥鲠祯弩换婶弪狒秭弪珧秕痼轭箫螋邃栳箬矧溴蚝箫螋邃磲痂狍＇灬礅溽ㄧ蝻躔栳箬珧秕皓箦翩疳翳钺礤躔溽翦栳箬疳翳溟珏篝弪珧秕瓠栳箬珧秕忸镤弩钺礤疳翳钺礤颟┅珧秕痼换义趱蝾尤镰栳箬犷疳翳钺礤扉篝鸿狍ㄤ殓弩翦颦桢溟珏篝溟珏篝弪吼狒璀钺礤疳翳钺礤颟┅ㄤ彐躅珏舡徜赆沐铘忸镤瀛犷洵溟蝈泗轱聃徜殇⒁弭躜彘翳弪篚怅邈臾矧镡赍泗鲠祯镦翳聃徜轭溟汜糸铉麒殂镱麽翎脲怡翳т轵邈糸镱鲠祯瀹祜镳骘痱镳弪豉溟蝈泗轱瞟轭Жê篚怅邈稷ê镡赍泗Ⅱ┅骘忸镤ㄧ弭徜赆沐铘忸镤瀛钺礤ㄧ弭聃徜痱镳弪豉殇麒孱忸镤滹蝈趱蝾骝镯珏舡徜赆沐铘忸镤瀛犷洵溟蝈泗轱鲠祯弩忸镤溟蝈泗轱瞟┅鲠祯弩铋铋飑ㄤ彐躅珧秕瓠忸镤弩怡栳箬ㄩ忸镤弩钺礤疳翳钺礤颟⑶蝻躔徜赆沐铘忸镤弩怡栳箬脲屦痱镳弪糸弩蝈驽蝈钽弩箦疳蜥翦义趱蝾栳箬磲鏖翳狎蜥鲠祯弩戾è珧秕痼磲脲篝蜷铉栳箬翎忪濠聃徜ㄧ弭ㄧ弭栳箬殇忸镤弩厚踽潴┅祜镳骘聃徜徙蝻篌聃徜滹换珏徜赆沐铘忸镤眭祠轲戾鲠祯瀛忾钿ㄢ铒溴溟蝈泗轱瞟ㄧ弭徜赆沐铘忸镤瀛犷洵溟蝈泗轱聃徜殇麒孱忸镤换珏忸镤钺礤趄汜铒铋汜飕疳翳翳孱栳箬戾è钺礤ㄣ镱è钺礤颦轶钺礤钺礤忸镤濠钺礤颦珏舡钺礤钺礤忸镤濠è钺礤颦轶钺礤疳翳钺礤忸镤濠钺礤颦珏舡钺礤疳翳钺礤忸镤濠ㄨ狍璀聃徜忸镤忸镤弩┅┅ㄧ蝻躔溟珏篝弪磲脲箬岜溟珏篝弪┅换柔箬溟蝈泗轱瞵痱镳弪豉犷忸镤钺礤栳箬ㄤ殓弩翦颦徜洵篝蜷铉珧秕瓠溟珏篝弪溟蝈泗轱瞟ㄤ殓弩翦颦徜洵篝蜷铉珧秕瓠溟珏篝弪ㄧ弭ㄧ弭聃徜吼蝈溟汜翦忽犰蹂┅ㄤ殓弩翦颦徜洵篝蜷铉珧秕瓠溟珏篝弪钺礤换龄忸镤麸栳箬珧秕鲥泗矧瘐箬屮翦钿忸镤ㄨ狍梏徕戾箦翡彐狨祠珧秕痼ㄤ殓弩翦颦桢溟珏篝珧秕瓠溟珏篝弪磲脲澌钺黹悱狎蜥┅┅┅珧秕痼┅ㄤ彐躅珏舡徜赆沐铘忸镤瀛钺礤铒溴殇⒘桢祓弪骢钽糸镱翳狒珏趔翳忪犷铒溴钺礤骝镯犷夷聃徜铒溴篚怅邈矧镡赍泗┊涉翳铒溴轶铒忪犷铒溴矧轸鲠祯滹弩铒磲翥翳玳鲥忪犷铒溴赡铋鏖祆忮蝈趱蝾邃ㄩㄡ钿ㄥ聃犰ㄧ弭铒溴呼疱忪犷氕铒溴豉疱铒ㄥ聃犰ㄧ弭铒溴忽犰蹂殇┅ㄧ弭铒溴忽犰蹂铋飑ㄤ彐躅躔溽翦栳箬疳翳ㄤ殓弩翦珧秕瓠栳箬珧秕忸镤弩钺礤疳翳钺礤颟⒁弭躜铙铄汨矬孱疳翳钺礤虍换拈珏篝珧秕栳箬ㄤ殓弩翦颦徜洵篝蜷铉溟珏篝弪珧秕瓠栳箬换描镲箦疳翳犷钺礤骝镯翳疱蝽豸狒轱铙眭祠轲戾鲠祯瀛忾钿ㄣ栾箦瞽疳翳汨矬孱钺礤颟ㄣ栾矬瀛疳翳犷洵钺礤珧秕忸镤弩钺礤疳翳钺礤颟换拈珏篝汨矬孱疳翳犷躔溽翦钺礤蚝ㄤ殓弩翦颦徜洵篝蜷铉溟珏篝弪汨矬孱疳翳汨矬孱钺礤颟ㄤ彐躅篝蜷铉疱蝽豸狒轱瞽铄ㄥ戾礤铘螬⒚栳铉屐屙孱趔ㄡ狎蜥镦篝蜷铉螬轭痨徙麸痱镤蹉铄疱蝽豸狒轱轭戾殂镧蜥痂殂矧溴虍义趱蝾铋殒铒盹蝈疱蝽豸狒轱铙屮轶舢戾è屐屙泔躅ū戾铉翳屐屙孱趔┅┅祜镳骘骝镯ū屐屙泔躅舂滹黝麸麒孱篝蜷铉ㄥ祠屐屙孱趔椹ㄥ祠屐屙孱趔ū椹┅滹祜镳骘骝镯屐屙泔躅滹黝麸麒孱篝蜷铉ㄥ祠屐屙孱趔椹ㄥ祠屐屙孱趔氅滹蝻翎翦ㄥ祠屐屙孱趔椹ㄥ祠屐屙孱趔氅箦翩ū屐屙泔躅舂祜镳麒殪ㄩ钽椹ㄤ邈氅滹蝻翎翦ㄥ祠屐屙孱趔椹ㄥ祠屐屙孱趔氅┅蝈趱蝾骝镯篝蜷铉疱蝽豸狒轱瞽铄屐屙孱趔┅┅ㄤ彐躅篝蜷铉疱蝽豸狒轱瞽轭轸ㄥ戾礤铘螬⑸铋糸犰辁疱蝽豸狒轱镦犷狎蜥镦篝蜷铉螽箫螋屐屙孱趔＇篝蜷铉缉ㄤ彐躅汨镲箦疳翳犷洵钺礤ㄧ蝻躔忸镤弩钺礤疳翳钺礤颟⒚栾矬疳翳犷钺礤骘玳鲥疱蝽豸狒轱ㄧ蝻躔┊麒孱弪镳戾铉翳珧秕皓蝈趱蝾骝镯汨镲箦疳翳犷洵钺礤鲠祯弩铋铋飑┅戾è汨矬孱疳翳铋飑ㄣ栾箦瞽钺礤铋飑ㄧ蝻躔疱蝽豸狒轱磲鲥泗矧＇殇孱糸豉珧秕皓┅篝蜷铉疱蝽豸狒轱瞽轭轸珧秕瓠疱蝽豸狒轱瞟祜镳麒殪珧秕瓠疱蝽豸狒轱滹ㄢ祜汶珧秕瓠疱蝽豸狒轱瞽祜镳戾è疳翳钺礤颦泔瘗钺礤颦沆镱疳翳钺礤颟疳翳蝈沲蝮磲脲澌钺黹悱狎蜥┅祜镳骘忸镤徙蝻篌珧秕瓠疱蝽豸狒轱滹换阵汜铒铋汜钺礤殒狯衢灬忪ㄩ钺礤颦轶钺礤钺礤忸镤濠箦翩疳翳ㄣ镱汜翦钺翦篝蜷铉疳翳钺礤颦珏舡钺礤钺礤忸镤濠┅痱镧换义沲蝮殒忸镤轶瞌钺礤轭翳疳翳弭躅戾篌钺礤颦轶钺礤疳翳钺礤颦泔瘗忸镤濠鲥泗矧瘐箬屮翦钿忸镤蝈沲蝮濠箦翩疳翳ㄣ镱汜翦钺翦篝蜷铉疳翳钺礤颦珏舡钺礤疳翳钺礤颦泔瘗忸镤濠┅┅换与轲疱蝽豸狒轱殒疳翳轶犰蝈徜窘汨矬孱疳翳麒孱ㄡ钿汨矬孱疳翳窘戾铉翳疳翳戾铉翳汨矬孱疳翳┅篝蜷铉疳翳汨矬孱疳翳┅蝈趱蝾骝镯珧秕瓠疱蝽豸狒轱瞽祜镳┅换义沲蝮祜镳骘忸镤徙蝻篌蝈沲蝮骘蝈篚祠ㄨ狍璀疳翳忸镤忸镤弩钺礤疳翳钺礤颦泔瘗滹箦翩疳翳ㄣ镱汜翦钺翦篝蜷铉疳翳钺礤颦珏舡钺礤疳翳钺礤颦泔瘗忸镤濠ㄦ矧磲铋⒓峋ㄧ弭蝈篚祠鸿狍瑭┅箦翩疳翳钺礤颦泔瘗ㄧ弭蝈篚祠吼狒璀钺礤颟换与轲疱蝽豸狒轱殒疳翳轶犰蝈徜窘汨矬孱疳翳麒孱ㄡ钿汨矬孱疳翳窘戾铉翳疳翳戾铉翳汨矬孱疳翳┅篝蜷铉疳翳汨矬孱疳翳┅蝈趱蝾骝镯珧秕瓠疱蝽豸狒轱瞽祜镳┅麒孱矧铒汨矬孱疳翳篝蜷铉疳翳汨矬孱疳翳┅箦翩汨矬孱疳翳疳翳汨矬孱钺礤疳翳钺礤颦泔瘗┅┅箦翩珧秕瓠疱蝽豸狒轱篝蜷铉疱蝽豸狒轱瞽铄珧秕瓠疱蝽豸狒轱瞟┅鲠祯弩汨矬孱疳翳汨矬孱钺礤颟┅